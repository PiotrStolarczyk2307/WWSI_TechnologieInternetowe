<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ćwiczenia - JavaScript zaawansowane
</title>
</head>
<body>
    <style>
    table {
      width: 100%; /* Tabela zajmuje całą szerokość strony */
      border-collapse: collapse; /* Scalanie granic komórek */
      margin-top: 20px; /* Odstęp od góry strony */
    }
    th, td {
      border: 1px solid #333; /* Obramowanie komórek */
      padding: 8px; /* Wewnętrzny odstęp w komórkach */
      text-align: left; /* Wyrównanie tekstu do lewej */
    }
    th {
      background-color: #f0f0f0; /* Kolor tła nagłówka tabeli */
    }
  </style>
</head>
<body>
  <h1>Lista użytkowników</h1> <!-- Nagłówek strony -->
  <button id="loadUsers">Załaduj użytkowników</button> <!-- Przycisk do pobrania użytkowników -->
  <table id="usersTable">
    <thead>
      <tr>
        <th>ID</th> <!-- Nagłówek kolumny: ID -->
        <th>Imię</th> <!-- Nagłówek kolumny: Imię -->
        <th>Nazwa użytkownika</th> <!-- Nagłówek kolumny: Username -->
        <th>Email</th> <!-- Nagłówek kolumny: Email -->
        <th>Miasto</th> <!-- Nagłówek kolumny: Miasto -->
        <th>Firma</th> <!-- Nagłówek kolumny: Firma -->
      </tr>
    </thead>
    <tbody>
      <!-- Dane użytkowników będą tutaj wstawiane dynamicznie -->
    </tbody>
  </table>

  <script>
    const tableBody = document.querySelector('#usersTable tbody'); // Pobranie elementu <tbody> tabeli
    const loadBtn = document.getElementById('loadUsers'); // Pobranie przycisku do ładowania użytkowników

    // Funkcja do wyświetlania użytkowników w tabeli
    function displayUsers(users) {
      tableBody.innerHTML = ''; // Czyszczenie tabeli przed dodaniem nowych danych
      users.forEach(user => { // Iteracja po wszystkich użytkownikach
        const row = document.createElement('tr'); // Tworzenie nowego wiersza w tabeli
        row.innerHTML = `
          <td>${user.id}</td> <!-- Wstawienie ID użytkownika -->
          <td>${user.name}</td> <!-- Wstawienie imienia użytkownika -->
          <td>${user.username}</td> <!-- Wstawienie nazwy użytkownika -->
          <td>${user.email}</td> <!-- Wstawienie email użytkownika -->
          <td>${user.address.city}</td> <!-- Wstawienie miasta użytkownika -->
          <td>${user.company.name}</td> <!-- Wstawienie nazwy firmy użytkownika -->
        `;
        tableBody.appendChild(row); // Dodanie wiersza do tabeli
      });
    }

    // Funkcja do pobrania danych z API
    async function fetchUsers() {
      try {
        const response = await fetch('https://jsonplaceholder.typicode.com/users'); // Pobranie danych z API
        if (!response.ok) throw new Error('Błąd sieci'); // Sprawdzenie, czy odpowiedź jest poprawna
        const users = await response.json(); // Konwersja odpowiedzi na JSON
        displayUsers(users); // Wyświetlenie użytkowników w tabeli
        localStorage.setItem('lastUsers', JSON.stringify(users)); // Zapisanie danych do localStorage
      } catch (error) {
        console.error('Nie udało się pobrać użytkowników:', error); // Obsługa błędów pobierania
      }
    }

    // Sprawdzenie czy mamy dane w localStorage przy ładowaniu strony
    document.addEventListener('DOMContentLoaded', () => {
      const savedUsers = localStorage.getItem('lastUsers'); // Pobranie zapisanych danych z localStorage
      if (savedUsers) {
        displayUsers(JSON.parse(savedUsers)); // Wyświetlenie zapisanych danych, jeśli istnieją
      }
    });

    // Pobranie danych po kliknięciu przycisku
    loadBtn.addEventListener('click', fetchUsers); // Przypisanie funkcji fetchUsers do kliknięcia przycisku
  </script>
</body>

</html>